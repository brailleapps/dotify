apply plugin: "java"
apply plugin: "maven"

group = "org.daisy.dotify"
version = "1.0-SNAPSHOT"

repositories {
    mavenCentral()
    mavenLocal()
    maven { url "https://oss.sonatype.org/content/repositories/snapshots" }
}

sourceSets {
    main {
        java { srcDir "src" }
        resources { srcDir "src" }
    }
    test {
        java { srcDir "test" }
        resources { srcDir "test" }
    }
}

configurations {
    provided {
        transitive = true
        visible = true
    }
}

sourceSets {
    main.compileClasspath += configurations.provided
    main.runtimeClasspath -= configurations.provided
    test.compileClasspath += configurations.provided
    test.runtimeClasspath += configurations.provided
}

dependencies {
    compile group: "org.daisy.dotify", name: "dotify.api", version: "1.0-SNAPSHOT"
    compile group: "org.daisy.dotify", name: "dotify.common", version: "1.0-SNAPSHOT"
    compile group: "com.googlecode.texhyphj", name: "texhyphj", version: "1.2"
    provided group: "biz.aQute", name: "bndlib", version: "2.0.0.20130123-133441"
    testCompile group: "junit", name: "junit", version: "4.7"
}

compileJava {
    options.encoding = "UTF-8"
    sourceCompatibility = 1.6
    targetCompatibility = 1.6
    // FIXME: "bootstrap class path not set in conjunction with -source 1.6"
    // options.bootClasspath = "/usr/lib/jvm/java-6-openjdk/jre/lib/rt.jar"
}

buildscript {
    repositories { mavenCentral() }
    dependencies { classpath group: "org.dm.gradle", name: "bundle", version: "0.4" }
}

apply plugin: "bundle"

bundle {
    instructions << [
        "-include": "bnd.bnd",
        "SPI-Provider": "*"
    ]
}
